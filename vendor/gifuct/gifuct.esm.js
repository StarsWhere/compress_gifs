/* esm.sh - gifuct-js@2.1.2 */
var Q=Object.create;var R=Object.defineProperty;var V=Object.getOwnPropertyDescriptor;var W=Object.getOwnPropertyNames;var Y=Object.getPrototypeOf,$=Object.prototype.hasOwnProperty;var _=(a,e)=>()=>(e||a((e={exports:{}}).exports,e),e.exports);var ee=(a,e,r,t)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of W(e))!$.call(a,n)&&n!==r&&R(a,n,{get:()=>e[n],enumerable:!(t=V(e,n))||t.enumerable});return a};var re=(a,e,r)=>(r=a!=null?Q(Y(a)):{},ee(e||!a||!a.__esModule?R(r,"default",{value:a,enumerable:!0}):r,a));var D=_(y=>{"use strict";Object.defineProperty(y,"__esModule",{value:!0});y.loop=y.conditional=y.parse=void 0;var te=function a(e,r){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:t;if(Array.isArray(r))r.forEach(function(s){return a(e,s,t,n)});else if(typeof r=="function")r(e,t,n,a);else{var i=Object.keys(r)[0];Array.isArray(r[i])?(n[i]={},a(e,r[i],t,n[i])):n[i]=r[i](e,t,n,a)}return t};y.parse=te;var ae=function(e,r){return function(t,n,i,s){r(t,n,i)&&s(t,e,n,i)}};y.conditional=ae;var ne=function(e,r){return function(t,n,i,s){for(var d=[],u=t.pos;r(t,n,i);){var l={};if(s(t,e,n,l),t.pos===u)break;u=t.pos,d.push(l)}return d}};y.loop=ne});var E=_(f=>{"use strict";Object.defineProperty(f,"__esModule",{value:!0});f.readBits=f.readArray=f.readUnsigned=f.readString=f.peekBytes=f.readBytes=f.peekByte=f.readByte=f.buildStream=void 0;var ie=function(e){return{data:e,pos:0}};f.buildStream=ie;var K=function(){return function(e){return e.data[e.pos++]}};f.readByte=K;var oe=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return function(r){return r.data[r.pos+e]}};f.peekByte=oe;var F=function(e){return function(r){return r.data.subarray(r.pos,r.pos+=e)}};f.readBytes=F;var de=function(e){return function(r){return r.data.subarray(r.pos,r.pos+e)}};f.peekBytes=de;var se=function(e){return function(r){return Array.from(F(e)(r)).map(function(t){return String.fromCharCode(t)}).join("")}};f.readString=se;var ue=function(e){return function(r){var t=F(2)(r);return e?(t[1]<<8)+t[0]:(t[0]<<8)+t[1]}};f.readUnsigned=ue;var ce=function(e,r){return function(t,n,i){for(var s=typeof r=="function"?r(t,n,i):r,d=F(e),u=new Array(s),l=0;l<s;l++)u[l]=d(t);return u}};f.readArray=ce;var le=function(e,r,t){for(var n=0,i=0;i<t;i++)n+=e[r+i]&&Math.pow(2,t-i-1);return n},fe=function(e){return function(r){for(var t=K()(r),n=new Array(8),i=0;i<8;i++)n[7-i]=!!(t&1<<i);return Object.keys(e).reduce(function(s,d){var u=e[d];return u.length?s[d]=le(n,u.index,u.length):s[d]=n[u.index],s},{})}};f.readBits=fe});var X=_(I=>{"use strict";Object.defineProperty(I,"__esModule",{value:!0});I.default=void 0;var x=D(),o=E(),C={blocks:function(e){for(var r=0,t=[],n=e.data.length,i=0,s=(0,o.readByte)()(e);s!==r&&s;s=(0,o.readByte)()(e)){if(e.pos+s>=n){var d=n-e.pos;t.push((0,o.readBytes)(d)(e)),i+=d;break}t.push((0,o.readBytes)(s)(e)),i+=s}for(var u=new Uint8Array(i),l=0,p=0;p<t.length;p++)u.set(t[p],l),l+=t[p].length;return u}},pe=(0,x.conditional)({gce:[{codes:(0,o.readBytes)(2)},{byteSize:(0,o.readByte)()},{extras:(0,o.readBits)({future:{index:0,length:3},disposal:{index:3,length:3},userInput:{index:6},transparentColorGiven:{index:7}})},{delay:(0,o.readUnsigned)(!0)},{transparentColorIndex:(0,o.readByte)()},{terminator:(0,o.readByte)()}]},function(a){var e=(0,o.peekBytes)(2)(a);return e[0]===33&&e[1]===249}),ve=(0,x.conditional)({image:[{code:(0,o.readByte)()},{descriptor:[{left:(0,o.readUnsigned)(!0)},{top:(0,o.readUnsigned)(!0)},{width:(0,o.readUnsigned)(!0)},{height:(0,o.readUnsigned)(!0)},{lct:(0,o.readBits)({exists:{index:0},interlaced:{index:1},sort:{index:2},future:{index:3,length:2},size:{index:5,length:3}})}]},(0,x.conditional)({lct:(0,o.readArray)(3,function(a,e,r){return Math.pow(2,r.descriptor.lct.size+1)})},function(a,e,r){return r.descriptor.lct.exists}),{data:[{minCodeSize:(0,o.readByte)()},C]}]},function(a){return(0,o.peekByte)()(a)===44}),ge=(0,x.conditional)({text:[{codes:(0,o.readBytes)(2)},{blockSize:(0,o.readByte)()},{preData:function(e,r,t){return(0,o.readBytes)(t.text.blockSize)(e)}},C]},function(a){var e=(0,o.peekBytes)(2)(a);return e[0]===33&&e[1]===1}),ye=(0,x.conditional)({application:[{codes:(0,o.readBytes)(2)},{blockSize:(0,o.readByte)()},{id:function(e,r,t){return(0,o.readString)(t.blockSize)(e)}},C]},function(a){var e=(0,o.peekBytes)(2)(a);return e[0]===33&&e[1]===255}),xe=(0,x.conditional)({comment:[{codes:(0,o.readBytes)(2)},C]},function(a){var e=(0,o.peekBytes)(2)(a);return e[0]===33&&e[1]===254}),Be=[{header:[{signature:(0,o.readString)(3)},{version:(0,o.readString)(3)}]},{lsd:[{width:(0,o.readUnsigned)(!0)},{height:(0,o.readUnsigned)(!0)},{gct:(0,o.readBits)({exists:{index:0},resolution:{index:1,length:3},sort:{index:4},size:{index:5,length:3}})},{backgroundColorIndex:(0,o.readByte)()},{pixelAspectRatio:(0,o.readByte)()}]},(0,x.conditional)({gct:(0,o.readArray)(3,function(a,e){return Math.pow(2,e.lsd.gct.size+1)})},function(a,e){return e.lsd.gct.exists}),{frames:(0,x.loop)([pe,ye,xe,ve,ge],function(a){var e=(0,o.peekByte)()(a);return e===33||e===44})}],he=Be;I.default=he});var Z=_(M=>{"use strict";Object.defineProperty(M,"__esModule",{value:!0});M.deinterlace=void 0;var me=function(e,r){for(var t=new Array(e.length),n=e.length/r,i=function(A,v){var c=e.slice(v*r,(v+1)*r);t.splice.apply(t,[A*r,r].concat(c))},s=[0,4,2,1],d=[8,8,4,2],u=0,l=0;l<4;l++)for(var p=s[l];p<n;p+=d[l])i(p,u),u++;return t};M.deinterlace=me});var H=_(j=>{"use strict";Object.defineProperty(j,"__esModule",{value:!0});j.lzw=void 0;var be=function(e,r,t){var n=4096,i=-1,s=t,d,u,l,p,T,A,v,b,c,h,w,z,m,g,U,P,G=new Array(t),O=new Array(n),S=new Array(n),k=new Array(n+1);for(z=e,u=1<<z,T=u+1,d=u+2,v=i,p=z+1,l=(1<<p)-1,c=0;c<u;c++)O[c]=0,S[c]=c;var w,b,N,m,g,P,U;for(w=b=N=m=g=P=U=0,h=0;h<s;){if(g===0){if(b<p){w+=r[U]<<b,b+=8,U++;continue}if(c=w&l,w>>=p,b-=p,c>d||c==T)break;if(c==u){p=z+1,l=(1<<p)-1,d=u+2,v=i;continue}if(v==i){k[g++]=S[c],v=c,m=c;continue}for(A=c,c==d&&(k[g++]=m,c=v);c>u;)k[g++]=S[c],c=O[c];m=S[c]&255,k[g++]=m,d<n&&(O[d]=v,S[d]=m,d++,(d&l)===0&&d<n&&(p++,l+=d)),v=A}g--,G[P++]=k[g],h++}for(h=P;h<s;h++)G[h]=0;return G};j.lzw=be});var L=_(B=>{"use strict";Object.defineProperty(B,"__esModule",{value:!0});B.decompressFrames=B.decompressFrame=B.parseGIF=void 0;var _e=ze(X()),Se=D(),ke=E(),we=Z(),Ae=H();function ze(a){return a&&a.__esModule?a:{default:a}}var Pe=function(e){var r=new Uint8Array(e);return(0,Se.parse)((0,ke.buildStream)(r),_e.default)};B.parseGIF=Pe;var Ue=function(e){for(var r=e.pixels.length,t=new Uint8ClampedArray(r*4),n=0;n<r;n++){var i=n*4,s=e.pixels[n],d=e.colorTable[s]||[0,0,0];t[i]=d[0],t[i+1]=d[1],t[i+2]=d[2],t[i+3]=s!==e.transparentIndex?255:0}return t},J=function(e,r,t){if(!e.image){console.warn("gif frame does not have associated image.");return}var n=e.image,i=n.descriptor.width*n.descriptor.height,s=(0,Ae.lzw)(n.data.minCodeSize,n.data.blocks,i);n.descriptor.lct.interlaced&&(s=(0,we.deinterlace)(s,n.descriptor.width));var d={pixels:s,dims:{top:e.image.descriptor.top,left:e.image.descriptor.left,width:e.image.descriptor.width,height:e.image.descriptor.height}};return n.descriptor.lct&&n.descriptor.lct.exists?d.colorTable=n.lct:d.colorTable=r,e.gce&&(d.delay=(e.gce.delay||10)*10,d.disposalType=e.gce.extras.disposal,e.gce.extras.transparentColorGiven&&(d.transparentIndex=e.gce.transparentColorIndex)),t&&(d.patch=Ue(d)),d};B.decompressFrame=J;var Fe=function(e,r){return e.frames.filter(function(t){return t.image}).map(function(t){return J(t,e.gct,r)})};B.decompressFrames=Fe});var q=re(L()),{__esModule:Oe,decompressFrames:De,decompressFrame:Ee,parseGIF:Re}=q,Ke=q.default??q;export{Oe as __esModule,Ee as decompressFrame,De as decompressFrames,Ke as default,Re as parseGIF};
